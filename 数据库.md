### user表

存储用户（病人）、医生、管理员

| 字段         | 类型         | 约束                 | 解释                 |
| ------------ | ------------ | -------------------- | -------------------- |
| id           | int(11)      | 主键、not null、自增 |                      |
| userName     | varchar(255) | not null             | 账号                 |
| registerTime | timestamp    | not null             | 注册时间             |
| isRegister   | int(11)      | not null             | 注册状态             |
| doctorId     | int(11)      | null                 | **病人关联医生的ID** |

### role表

该表存储角色，三个角色

| 字段     | 类型         | 约束                 | 解释     |
| -------- | ------------ | -------------------- | -------- |
| id       | int(11)      | 主键、not null、自增 |          |
| role     | varchar(255) | not null             | 角色符号 |
| roleName | varchar(255) | not null             | 角色名   |



### userrole表

该表关联user表和role表

| 字段   | 类型    | 约束                 | 解释                 |
| ------ | ------- | -------------------- | -------------------- |
| id     | int(11) | 主键、not null、自增 |                      |
| userId | int(11) | not null             | **关联user表中的id** |
| roleId | int(11) | not null             | **关联role表中的id** |



### question表

问卷表，该表只存储两个问卷：答题问卷、PSA问卷,答题问卷的id是1、PSA问卷id时2

| 字段     | 类型         | 约束                 | 解释     |
| -------- | ------------ | -------------------- | -------- |
| id       | int(11)      | 主键、not null、自增 | 问卷的ID |
| quesName | varchar(255) | not null             | 问卷名   |
| quesInfo | varchar(255) | not null             | 问卷简介 |

### field表

题表，存储**答题问卷**的每个问题

| 字段       | 类型         | 约束                 | 解释                               |
| ---------- | ------------ | -------------------- | ---------------------------------- |
| id         | int(11)      | 主键、not null、自增 | 题的ID                             |
| fieldName  | varchar(255) | not null             | 题名                               |
| chosse     | varchar(255) | null                 | 待选答案（#号分隔）                |
| score      | varchar(255) | null                 | 待选答案分数（#号分隔）            |
| quesId     | int(11)      | not null             | **关联问卷id（question的id）**     |
| chosseType | varchar(255) | not null             | **题目类型，关联chosseType中的id** |

### filedValue表

存储每道题目的答案

| 字段        | 类型         | 约束                 | 解释                          |
| ----------- | ------------ | -------------------- | ----------------------------- |
| id          | int(11)      | 主键、not null、自增 | 答案ID                        |
| fieldId     | int(11)      | not null             | **关联题的ID（field中的id）** |
| chosseValue | varchar(255) | not null             | 该题选择的答案（#号分隔）     |
| userId      | int(11)      | not null             | **关联user表中的id**          |
| subId       | int(11)      | not null             | **关联userques中的id**        |



### chossetype表

存储field表中的每道题的类型

| 字段           | 类型         | 约束                 | 解释     |
| -------------- | ------------ | -------------------- | -------- |
| id             | int(11)      | 主键、not null、自增 |          |
| chosseType     | varchar(255) | not null             | 类型标志 |
| chosseTypeName | varchar(255) | not null             | 类型解释 |



### unfield表

存储特殊题的子题（chossetype为6的题）

| 字段        | 类型         | 约束                 | 解释                  |
| ----------- | ------------ | -------------------- | --------------------- |
| id          | int(20)      | 主键、not null、自增 |                       |
| fieldId     | int(20)      | not null             | **关联field表中的id** |
| unFieldId   | int(20)      | not null             | 特殊题的子题id        |
| unFieldName | varchar(255) | not null             | 特殊题的子题名        |



### unfieldvalue表

存储子题选择的答案

| 字段         | 类型         | 约束                 | 解释                           |
| ------------ | ------------ | -------------------- | ------------------------------ |
| id           | int(11)      | 主键、not null、自增 |                                |
| unFieldId    | int(11)      | null                 | **关联unfield表中的unFieldId** |
| unFieldValue | varchar(255) | null                 | 子题选择的答案                 |
| userId       | int(11)      | null                 | **关联user表中的id**           |
| subId        | int(11)      | not null             | **关联userques表中的id**       |

### psavalue表

存储PSA表上传的内容：图片、手动选择的时间

| 字段       | 类型         | 约束                 | 解释                             |
| ---------- | ------------ | -------------------- | -------------------------------- |
| id         | int(11)      | 主键、not null、自增 |                                  |
| quesId     | int(11)      | not null             | **关联question表中的id（id=2）** |
| photoUrl   | varchar(255) | not null             | 存储照片的路径                   |
| selectTime | timestamp    | not null             | 病人手动上传的时间               |
| userId     | int(11)      | not null             | 关联user表中的id                 |
| subId      | int(11)      | not null             | **关联userques表中的id**         |

### userques表

病人提交问卷记录的表

| 字段     | 类型      | 约束                 | 解释                         |
| -------- | --------- | -------------------- | ---------------------------- |
| id       | int(11)   | 主键、not null、自增 |                              |
| quesId   | int(11)   | not null             | **关联question表中的id**     |
| userId   | int(11)   | not null             | **关联user表中的id**         |
| isSub    | int(11)   | not null             | 是否提交                     |
| subScore | int(3)    | not null             | 答题问卷的提交分数           |
| subTime  | timestamp |                      | 问卷提交时间                 |
| pubTime  | timestamp |                      | 问卷发布时间                 |
| endTime  | timestamp |                      | 问卷截止时间                 |
| isRead   | int(2)    | not null             | 病人提交问卷后，医生是否阅读 |

### catlog表

存储病人与医生消息的表

| 字段     | 类型         | 约束                 | 解释                     |
| -------- | ------------ | -------------------- | ------------------------ |
| id       | int(11)      | 主键、not null、自增 |                          |
| userId   | int(11)      | not null             | **关联user表中病人的id** |
| doctorId | int(11)      | not null             | **关联user表中医生的id** |
| subId    | int(11)      | not null             | **关联userques表中的id** |
| content  | varchar(255) | null                 | 消息内容                 |
| senderId | int(11)      | not null             | 发送者的id               |
| sendTime | timestamp    | not null             | 发送时间                 |
| isRead   | int(2)       | not null             | 此消息对方是否已读       |


``` mysql 
添加索引
ALTER TABLE user ADD INDEX u_n_index (username);
ALTER TABLE field ADD INDEX ques_id_index (quesId);
ALTER TABLE fieldvalue ADD INDEX fs_index (fieldId , subId);
ALTER TABLE unfield ADD INDEX f_uf_index(fieldId , unFieldId);
ALTER TABLE unfieldvalue ADD INDEX uf_s_index(unFieldId , subId);
```

